<!DOCTYPE html>
<html>
  <head>
    <title>Webcam Recorder</title>
  </head>
  <body>
    <h1>Webcam Recorder</h1>
    <video id="video" width="640" height="480" autoplay></video>
    <button id="record-button">Record</button>
    <button id="stop-button" disabled>Stop</button>
    <script>
      const videoElement = document.getElementById("video");
      const recordButton = document.getElementById("record-button");
      const stopButton = document.getElementById("stop-button");
      let mediaRecorder;
      let chunks = [];

      navigator.mediaDevices
        .getUserMedia({ audio: true, video: true })
        .then(function (stream) {
          videoElement.srcObject = stream;
          mediaRecorder = new MediaRecorder(stream);

          mediaRecorder.ondataavailable = function (e) {
            chunks.push(e.data);
          };

          mediaRecorder.onstop = function () {
            const blob = new Blob(chunks, { type: "video/mp4" });
            const formData = new FormData();
            formData.append("video", blob);

            fetch("upload.php", {
              method: "POST",
              body: formData,
            })
          };
        })
        .catch(function (err) {
          console.log("Error: " + err);
        });

      recordButton.onclick = function () {
        chunks = [];
        mediaRecorder.start();
        recordButton.disabled = true;
        stopButton.disabled = false;
      };

      stopButton.onclick = function () {
        mediaRecorder.stop();
        recordButton.disabled = false;
        stopButton.disabled = true;
      };
    </script>
  </body>
</html>
